添加字段
最后更新：2025/06/06
添加字段
本接口用于在智能表中的某个子表里添加一列或多列新字段。单表最多允许有150个字段。

请求方式：POST(HTTPS)
请求地址：https://qyapi.weixin.qq.com/cgi-bin/wedoc/smartsheet/add_fields?access_token=ACCESS_TOKEN

请求包体：

{
	"docid": "DOCID",
	"sheet_id": "SHEETID",
	"fields": [{
		"field_title": "TITLE",
		"field_type": "FIELD_TYPE_TEXT"
	}]
}
参数说明

参数	类型	是否必须	说明
docid	string	是	文档的docid
sheet_id	string	是	表格ID
fields	object [] (AddFiled)	是	字段详情
权限说明

自建应用需配置到“可调用应用”列表中的应用secret所获取的accesstoken来调用（accesstoken如何获取？）
第三方应用需具有“文档”权限
代开发自建应用需具有“文档”权限
返回示例

{
	"errcode": 0,
	"errmsg": "ok",
	"fields": [{
		"field_id": "FIELDID",
		"field_title": "TITLE",
		"field_type": "FIELD_TYPE_TEXT"
	}]
}
参数说明

参数	类型	说明
errcode	int32	错误码
errmsg	string	错误码说明
fields	object [] (Filed)	字段详情
参数详细说明
AddField
字段信息：
注意
字段属性与字段类型是匹配的，一种字段类型对应一种字段属性
 

参数名	类型	是否必填	描述
field_title	string	是	字段标题
field_type	string	是	字段类型，见FieldType ，必须为原属性
property_number	object(NumberFieldProperty)	是	数字 类型的字段属性
property_checkbox	object(CheckboxFieldProperty)	否	复选框 类型的字段属性
property_date_time	object(DateTimeFieldProperty)	是	日期 类型的字段属性
property_attachment	object(AttachmentFieldProperty)	否	文件 类型的字段属性
property_user	object(UserFieldProperty)	否	人员 类型的字段属性
property_url	object(UrlFieldProperty)	是	超链接 类型的字段属性
property_select	object(SelectFieldProperty)	是	多选 类型的字段属性
property_created_time	object(CreatedTimeFieldProperty)	是	创建时间 类型的字段属性
property_modified_time	object(ModifiedTimeFieldProperty)	是	最后编辑时间 类型的字段属性
property_progress	object(ProgressFieldProperty)	是	进度 类型的字段属性
property_single_select	object(SingleSelectFieldProperty)	是	单选 类型的字段属性
property_reference	object(ReferenceFieldProperty)	是	引用 类型的字段属性
property_location	object(LocationFieldProperty)	是	地理位置 类型的字段属性
property_auto_number	object(AutoNumberFieldProperty)	是	自动编号 类型的字段属性
property_currency	object(CurrencyFieldProperty)	是	货币 类型的字段属性
property_ww_group	object(WwGroupFieldProperty)	否	群 类型的字段属性
property_percentage	object(PercentageFieldProperty)	否	百分数 类型的字段属性
property_barcode	object(BarcodeFieldProperty)	否	条码 类型的字段属性
FieldType
字段类型	说明
FIELD_TYPE_TEXT	文本
FIELD_TYPE_NUMBER	数字
FIELD_TYPE_CHECKBOX	复选框
FIELD_TYPE_DATE_TIME	日期
FIELD_TYPE_IMAGE	图片
FIELD_TYPE_ATTACHMENT	文件
FIELD_TYPE_USER	成员
FIELD_TYPE_URL	超链接
FIELD_TYPE_SELECT	多选
FIELD_TYPE_CREATED_USER	创建人
FIELD_TYPE_MODIFIED_USER	最后编辑人
FIELD_TYPE_CREATED_TIME	创建时间
FIELD_TYPE_MODIFIED_TIME	最后编辑时间
FIELD_TYPE_PROGRESS	进度
FIELD_TYPE_PHONE_NUMBER	电话
FIELD_TYPE_EMAIL	邮件
FIELD_TYPE_SINGLE_SELECT	单选
FIELD_TYPE_REFERENCE	关联
FIELD_TYPE_LOCATION	地理位置
FIELD_TYPE_CURRENCY	货币
FIELD_TYPE_WWGROUP	群
FIELD_TYPE_AUTONUMBER	自动编号
FIELD_TYPE_PERCENTAGE	百分数
FIELD_TYPE_BARCODE	条码
NumberFieldProperty
数字类型字段属性信息：

参数名	类型	描述
decimal_places	int(DecimalPlaces)	表示小数点的位数，即数字精度
use_separate	bool	是否使用千位符，设置此属性后数字字段将以英文逗号分隔千分位，如 1,000
CheckboxFieldProperty
复选框类型字段属性信息：

参数名	类型	描述
checked	bool	新增时是否默认勾选
DateTimeFieldProperty
日期类型字段属性信息：

参数名	类型	描述
format	string(Format)	设置日期格式
auto_fill	bool	新建记录时，是否自动填充时间
AttachmentFieldProperty
文件类型字段属性信息：

参数名	类型	描述
display_mode	string(DisplayMode)	设置日期格式
UserFieldProperty
成员类型字段属性信息：

参数名	类型	描述
is_multiple	bool	允许添加多个人员
is_notified	bool	添加人员时通知用户，关闭后不通知
UrlFieldProperty
超链接类型字段属性信息：

参数名	类型	描述
type	string(LinkType)	超链接展示样式
SelectFieldProperty
多选类型字段属性信息：

参数名	类型	描述
is_quick_add	bool	是否允许填写时新增选项，用户不需要设置该参数
options	object [] ](Option)	多选选项的格式设置
CreatedTimeFieldProperty
创建时间类型字段属性信息：

参数名	类型	描述
format	string(Format)	设置日期格式
ModifiedTimeFieldProperty
最后编辑时间类型字段属性信息：

参数名	类型	描述
format	string(Format)	设置日期格式
ProgressFieldProperty
进度类型字段属性信息：

参数名	类型	描述
decimal_places	int(DecimalPlaces)	小数位数
SingleSelectFieldProperty
单选类型字段属性信息：

参数名	类型	描述
is_quick_add	bool	是否允许填写时新增选项，用户不需要设置该参数
options	object [] (Option)	单选选项的格式设置
ReferenceFieldProperty
关联字段属性信息：

参数名	类型	描述
sub_id	string	关联的子表id，为空时，表示关联本子表
filed_id	string	关联的字段id
is_multiple	bool	是否允许多选
view_id	string	视图id
LocationFieldProperty
地理位置字段属性信息：

参数名	类型	描述
input_type	string(LocationInputType)	输入类型
LocationFieldProperty
地理位置字段属性信息：

参数名	类型	描述
input_type	string(LocationInputType)	输入类型
AutoNumberFieldProperty
自动编号字段属性信息：

参数名	类型	描述
type	string(NumberType)	输入类型
rules	object[] (NumberRule)	自定义规则
reformat_existing_record	bool	是否应用于已有编号
CurrencyFieldProperty
货币类型字段属性

参数名	类型	描述
currency_type	string(CurrencyType)	输入类型
decimal_places	int(DecimalPlaces)	表示小数点的位数，即数字精度
use_separate	bool	是否使用千位符，设置此属性后数字字段将以英文逗号分隔千分位，如 1,000
 

WwGroupFieldProperty
群类型的字段属性

参数名	类型	描述
allow_multiple	bool	是否允许多个群聊
PercentageFieldProperty
百分数类型的字段属性

参数名	类型	描述
decimal_places	int(DecimalPlaces)	表示小数点的位数，即数字精度
use_separate	bool	是否使用千位符，设置此属性后数字字段将以英文逗号分隔千分位，如 1,000
BarcodeFieldProperty
条码类型的字段属性

参数名	类型	描述
mobile_scan_only	bool	仅限手机扫描录入


添加记录
最后更新：2025/09/11
添加记录
本接口用于在 Smartsheet 中的某个子表里添加一行或多行新记录。单表最多允许有100000行记录，15000000个单元格。
注意
不能通过添加记录接口给创建时间、最后编辑时间、创建人和最后编辑人四种类型的字段添加记录。

请求方式：POST(HTTPS)
请求地址：https://qyapi.weixin.qq.com/cgi-bin/wedoc/smartsheet/add_records?access_token=ACCESS_TOKEN

请求包体：

{
	"docid": "DOCID",
	"sheet_id": "123Abc",
	"key_type": "CELL_VALUE_KEY_TYPE_FIELD_TITLE",
	"records": [{
		"values": {
			"FILED_TITLE": [{
				"type": "text",
				"text": "文本内容"
			}]
		}
	}]
}
或

{
	"docid": "DOCID",
	"sheet_id": "123Abc",
	"key_type": "CELL_VALUE_KEY_TYPE_FIELD_ID",
	"records": [{
		"values": {
			"FILED_ID": [{
				"type": "text",
				"text": "文本内容"
			}]
		}
	}]
}
FILED_TITLE和FILED_ID需要替换为字段标题或者字段ID
 

参数说明

参数	类型	是否必须	说明
docid	string	是	文档的docid
sheet_id	string	是	Smartsheet 子表ID
key_type	string(CellValueKeyType)	否	返回记录中单元格的key类型，默认用标题
records	Object[](AddRecord)	是	需要添加的记录的具体内容组成的 JSON 数组
 

权限说明

自建应用需配置到“可调用应用”列表中的应用secret所获取的accesstoken来调用（accesstoken如何获取？）
第三方应用需具有“文档”权限
代开发自建应用需具有“文档”权限
返回示例

{
    "errcode": 0,
    "errmsg": "ok",
    "records": [
			
    ]
}
参数说明

参数	类型	说明
errcode	int32	错误码
errmsg	string	错误码说明
records	Object[](CommonRecord)	由添加成功的记录的具体内容组成的 JSON 数组
参数详细说明
 

CellValueKeyType
记录(CommonRecord 或 AddRecord)中key的类型

枚举类型	描述
CELL_VALUE_KEY_TYPE_FIELD_TITLE	key用字段标题表示
CELL_VALUE_KEY_TYPE_FIELD_ID	key用字段 ID 表示
AddRecord
添加记录：

参数名	类型	描述
values	Object	记录的具体内容，key 为字段标题或字段 ID ，value 详见(Value)
CommonRecord
在 Smartsheet 的某个表格中添加记录响应、更新记录请求和更新记录响应的通用参数：

参数名	类型	描述
record_id	string	记录 ID
values	Object	记录的具体内容，key 为字段标题或字段 ID ，value 详见(Value)
 

Value
各种类型的字段对应的单元格的值

字段类型	单元格值类型	描述
文本(FIELD_TYPE_TEXT)	Object[](CellTextValue)	 
数字(FIELD_TYPE_NUMBER)	double	 
复选框(FIELD_TYPE_CHECKBOX)	bool	 
日期(FIELD_TYPE_DATE_TIME)	string(以毫秒为单位的unix时间戳)	 
图片(FIELD_TYPE_IMAGE)	Object[](CellImageValue)	 
文件(FIELD_TYPE_ATTACHMENT)	Object[](CellAttachmentValue)	 
成员(FIELD_TYPE_USER)	Object[](CellUserValue)	 
链接(FIELD_TYPE_URL)	Object[](CellUrlValue)	数组类型为预留能力，目前只支持展示一个链接，建议只传入一个链接
多选(FIELD_TYPE_SELECT)	Object[](Option)	 
进度(FIELD_TYPE_PROGRESS)	double	 
电话(FIELD_TYPE_PHONE_NUMBER)	string	 
邮箱(FIELD_TYPE_EMAIL)	string	 
单选(FIELD_TYPE_SINGLE_SELECT)	Object[](Option)	 
地理位置(FIELD_TYPE_LOCATION)	Object[](CellLocationValue)	长度不大于1的数组。
货币(FIELD_TYPE_CURRENCY)	double	
百分数(FIELD_TYPE_PERCENTAGE)	double	
 

CellTextValue
文本类型字段的单元值类型

参数名	类型	描述
type	string	内容为文本(值为text)、内容为链接(值为url)
text	string	单元格内容
link	string	当type时url时，表示链接跳转url
CellImageValue
参数名	类型	描述
id	string	图片 ID,自定义id
title	string	图片标题
image_url	string	图片链接，通过上传图片接口获取
width	int32	图片宽度
height	int32	图片高度
CellAttachmentValue
示例

{
	"doc_type": 2,
	"file_ext": "SMARTSHEET",
	"file_id": "FILEID",
	"file_type": "70",
	"file_url": "https://doc.weixin.qq.com/smartsheet/xxx",
	"name": "智能表格",
	"size": 3267
}
参数名	类型	描述
name	string	文件名
size	int32	文件大小
file_ext	string	文件扩展名。文件夹为空，文件为对应文件拓展名，收集表为FORM，文档为DOC，表格为SHEET，幻灯片为SLIDE，思维导图为MIND，流程图为FLOWCHART，智能表为SMARTSHEET
file_id	string	文件ID
file_url	string	文件url ，如果是微盘文档则通过获取分享链接获得，如果是文档，则为文档url
file_type	string	文件类型。文件夹为Folder，微盘文件为Wedrive，收集表为30，文档为50，表格是51，幻灯片为52，思维导图为54，流程图为55，智能表为70
doc_type	string	文件类型，用于区分文件夹和文件
CellUserValue
参数名	类型	描述
user_id	string	成员ID
CellUrlValue
数组类型为预留能力，目前只支持展示一个链接，建议只传入一个链接
示例

{
	"link": "https://developer.work.weixin.qq.com/document/path/97392",
	"text": "企业微信开发者中心",
	"type": "url"
}
参数名	类型	描述
type	string	填url
text	string	链接显示文本
link	string	链接跳转url
 

Option
示例

{
	"id": "1"
}
参数名	类型	描述
id	string	选项ID，当选项存在时，通过ID识别选项，当需要新增选项，则不填写此字段
style	int(Style)	选项颜色。新增选项时填写
text	string	要填写的选项内容。新增选项时填写，已经存在时优先匹配已经存在的选项，否则会新增选项
CellLocationValue
示例

{
	"id": "14313005936863363130",
	"latitude": "23.10647",
	"longitude": "113.32446",
	"source_type": 1,
	"title": "广州塔"
}
参数名	类型	描述
source_type	uint32	填1，表示来源为腾讯地图。目前只支持腾讯地图来源
id	string	地点ID
latitude	string	纬度
longitude	string	经度
title	string	地点名称

更新记录
本接口用于更新 Smartsheet 中的某个子表里的一行或多行记录。
注意
不能通过更新记录接口给创建时间、最后编辑时间、创建人和最后编辑人四种类型的字段更新记录。

请求方式：POST(HTTPS)
请求地址：https://qyapi.weixin.qq.com/cgi-bin/wedoc/smartsheet/update_records?access_token=ACCESS_TOKEN

请求包体：

{
	"docid": "DOCID",
	"sheet_id": "123Abc",
	"key_type": "CELL_VALUE_KEY_TYPE_FIELD_TITLE",
	"records": [
	]
}
参数说明

参数	类型	是否必须	说明
docid	string	是	文档的docid
sheet_id	string	是	Smartsheet 子表ID
key_type	string(CellValueKeyType)	否	返回记录中单元格的key类型
records	Object[](UpdateRecord)	是	由需要更新的记录组成的 JSON 数组
 

权限说明

自建应用需配置到“可调用应用”列表中的应用secret所获取的accesstoken来调用（accesstoken如何获取？）
第三方应用需具有“文档”权限
代开发自建应用需具有“文档”权限
返回示例

{
    "errcode": 0,
    "errmsg": "ok",
    "records": [
    ]
}
参数说明

参数	类型	说明
errcode	int32	错误码
errmsg	string	错误码说明
records	Object[](CommonRecord)	由更新成功的记录的具体内容组成的 JSON 数组
参数详细说明
CellValueKeyType
记录(CommonRecord)中key的类型

枚举类型	描述
CELL_VALUE_KEY_TYPE_FIELD_TITLE	key用字段标题表示
CELL_VALUE_KEY_TYPE_FIELD_ID	key用字段 ID 表示
UpdateRecord
参数名	类型	描述
record_id	string	记录 ID
values	Object	记录的具体内容，key 为字段标题或字段 ID ，value 详见(Value)
CommonRecord
 

参数名	类型	描述
record_id	string	记录 ID
values	Object	记录的具体内容，key 为字段标题或字段 ID ，value 详见(Value)
 